document.addEventListener("DOMContentLoaded",function(t){const a=t=>{return d3.drag().on("start",a=>{d3.event.active||t.alphaTarget(.3).restart(),a.fx=a.x,a.fy=a.y,a.cursor="grabbing"}).on("drag",t=>{t.fx=d3.event.x,t.fy=d3.event.y}).on("end",a=>{d3.event.active||t.alphaTarget(0),a.fx=null,a.fy=null,a.cursor="grab"})},e=d3.hierarchy(data),r=e.links(),n=e.descendants(),o=n.filter(t=>t.data.img),d=n.filter(t=>!t.data.img),i=window.innerHeight-6,l=window.innerWidth,s=d3.select("body");s.style("margin","0").style("padding","0");const c=d3.forceSimulation(n).force("link",d3.forceLink(r).id(t=>t.id).distance(t=>t.target.data.distance).strength(.4)).force("charge",d3.forceManyBody().strength(-2500)).force("x",d3.forceX()).force("y",d3.forceY()),f=()=>{d3.event.transform.k<.005&&(d3.event.transform.k=10),d3.event.transform.k>10&&(d3.event.transform.k=.005),m.attr("transform",d3.event.transform)},g=s.append("svg").attr("viewBox",[-l/2,-i/2,l,i]).attr("cursor","move").call(d3.zoom().on("zoom",f)).on("dblclick.zoom",null),m=g.append("g"),y=m.append("g").attr("stroke","#999").attr("stroke-opacity",.6).selectAll("line").data(r).join("line"),u=m.append("g").selectAll("image").data(o).join("image").attr("xlink:href",t=>t.data.img).attr("height",150).attr("width",150).call(a(c)),x=m.append("g").selectAll("text").data(d).join("text").text(t=>t.data.name).attr("font-family","Marion").attr("font-size",t=>t.data.size||"40px").attr("fill","black").call(wrap,300).call(a(c)),h=d3.zoom().scaleExtent([1,40]).on("zoom",f);let p;u.on("mouseenter",function(){d3.select(this).attr("height",155).attr("width",155).raise()}).on("mouseleave",function(){d3.select(this).attr("height",150).attr("width",150)}).on("click",t=>{let a,e,r;t&&!(t=>t===p)(t)?(a=t.x,e=t.y,r=4,p=t):(a=0,e=0,r=.5,p=null),g.transition().ease(d3.easeCubic).duration(750).call(h.transform,d3.zoomIdentity.scale(r).translate(-a,-e))}),c.on("tick",()=>{y.attr("x1",t=>t.source.x).attr("y1",t=>t.source.y).attr("x2",t=>t.target.x).attr("y2",t=>t.target.y),u.attr("x",t=>t.x-75).attr("y",t=>t.y-75).attr("cursor",t=>t.cursor||"grab"),x.attr("x",t=>t.x-20).attr("y",t=>t.y).attr("cursor",t=>t.cursor||"grab")}),g.call(h.transform,d3.zoomIdentity.scale(1.2).translate(-600,-1500)),g.transition().ease(d3.easeCubic).delay(1500).duration(1e3).call(h.transform,d3.zoomIdentity.scale(.4).translate(-400,-800))});
